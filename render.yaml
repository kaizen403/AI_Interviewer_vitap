services:
  - type: web
    name: capstone-reviewer
    env: node
    plan: starter
    buildCommand: pnpm install && cd apps/backend && pnpm prisma generate && pnpm build && cd ../frontend && pnpm build
    startCommand: cd apps/backend && node dist/agent/voice-agent-router.js download-files || true && node dist/index.js & node dist/agent/voice-agent-router.js start & cd ../frontend && PORT=3000 node server.js
    envVars:
      - key: NODE_ENV
        value: production
      - key: DATABASE_URL
        sync: false
      - key: OPENAI_API_KEY
        sync: false
      - key: LIVEKIT_URL
        sync: false
      - key: LIVEKIT_API_KEY
        sync: false
      - key: LIVEKIT_API_SECRET
        sync: false
      - key: R2_ACCESS_KEY_ID
        sync: false
      - key: R2_SECRET_ACCESS_KEY
        sync: false
      - key: R2_ENDPOINT
        sync: false
      - key: R2_BUCKET_NAME
        sync: false
      - key: R2_PUBLIC_URL
        sync: false
